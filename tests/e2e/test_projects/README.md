# E2E Test Projects Directory

**Purpose**: Storage location for generated test project fixtures used in E2E testing of Claude Code plugins.

## Overview

This directory contains test project fixtures generated by `tools/generate_test_project.py` for testing plugin workflows. Test projects are temporary artifacts created during test execution and should not be committed to git.

## Usage

### Generating Test Projects

Use the test project generator CLI to create fixtures:

```bash
# Generate Python CLI project
python tools/generate_test_project.py \
  --output tests/e2e/test_projects/my-cli \
  --type cli \
  --language python \
  --name "My CLI Tool"

# Generate JavaScript web app
python tools/generate_test_project.py \
  --output tests/e2e/test_projects/web-app \
  --type web-app \
  --language javascript

# Generate Go library
python tools/generate_test_project.py \
  --output tests/e2e/test_projects/go-lib \
  --type library \
  --language go
```

### Test Project Structure

Generated projects follow realistic structures for their language and type:

**Python CLI Project**:
```
my-cli/
├── pyproject.toml
├── README.md
├── .gitignore
├── src/
│   └── my_cli/
│       ├── __init__.py
│       └── main.py
└── tests/
    └── test_main.py
```

**JavaScript CLI Project**:
```
my-cli/
├── package.json
├── README.md
├── .gitignore
├── bin/
│   └── cli.js
├── src/
│   └── index.js
└── __tests__/
    └── index.test.js
```

**Go CLI Project**:
```
my-cli/
├── go.mod
├── README.md
├── .gitignore
├── main.go
└── main_test.go
```

## Test Scenarios

### Example Use Cases

**agent-loop Testing**:
- Generate project with buggy code
- Test /explore command discovers issues
- Test /plan command creates implementation strategy
- Test /code command implements fixes
- Test /commit command creates git commit

**epti Testing**:
- Generate project skeleton
- Test /write-tests command creates test files
- Test /verify-fail command runs failing tests
- Test /commit-tests command commits tests
- Test /implement command implements passing code
- Test /iterate command refactors
- Test /commit-code command commits implementation

**visual-iteration Testing**:
- Generate web app with UI components
- Test /screenshot command captures current state
- Test /feedback command provides specific improvements
- Test /refine command applies CSS changes
- Test /iterate-loop command runs full cycle
- Test /commit-visual command commits polished result

## Cleanup

### Between Tests

Test projects should be cleaned up between test runs to ensure isolation:

```python
# Via MCP tool
harness.reset_test_environment()

# Or manually
rm -rf tests/e2e/test_projects/*
```

### After Test Suite

The `.gitignore` ensures generated projects are never committed to git. Test projects are ephemeral artifacts that should be regenerated for each test run.

## MCP Integration

### Using Test Projects in Tests

Test projects are accessed via the test harness MCP server:

```python
# In pytest test
def test_agent_loop_workflow(harness, test_session):
    # Generate test project
    project = harness.create_test_project(
        project_type="cli",
        language="python",
        output_path="/tmp/test-projects/proj-1"
    )

    # Initialize git
    harness.setup_git_repo(project["project_path"])

    # Add sample buggy code
    harness.create_sample_files(
        project_path=project["project_path"],
        file_specs=[
            {
                "path": "src/buggy.py",
                "content": "def add(a, b):\\n    return a - b  # Bug!"
            }
        ]
    )

    # Test plugin workflow on this project
    # ...
```

## Project Types Supported

| Type | Languages | Description |
|------|-----------|-------------|
| **cli** | Python, JavaScript, Go | Command-line application with subcommands |
| **web-app** | JavaScript (planned) | Web application with frontend/backend |
| **library** | Python (planned), Go (planned) | Reusable code library |

## Notes

- **Git Initialization**: Projects are generated WITHOUT git repos by default. Use `setup_git_repo()` MCP tool to initialize git.
- **Test Content**: Projects include realistic sample code (not empty files) to enable meaningful testing.
- **Multiple Languages**: Each language generates idiomatic project structures.
- **Extensibility**: New project types and languages can be added to `tools/generate_test_project.py`.

## See Also

- `tools/generate_test_project.py` - Generator implementation
- `tests/e2e/mcp_server/harness_server.py` - MCP server with test environment tools
- `tests/e2e/design/ARCHITECTURE.md` - Complete E2E test harness architecture
