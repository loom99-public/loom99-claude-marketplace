# dev-loop

A Claude Code plugin that adds structured workflow commands for development. Two main approaches: write tests first (TDD), or implement and validate as you go.

---

## Quickstart

```bash
# Install the marketplace
git clone https://github.com/loom99/loom99-claude-marketplace.git
cd loom99-claude-marketplace

# In Claude Code:
/plugin marketplace add .
/plugin install dev-loop
```

### Build something with TDD

```bash
# Start with evaluation to understand current state
/evaluate-and-plan user authentication

# Write tests, then implement
/test-and-implement

# Claude will:
# 1. Write tests that validate the behavior you need
# 2. Implement code that makes those tests pass
# 3. Re-evaluate to update status
```

### Build something without tests upfront

```bash
# Evaluate and plan first
/evaluate-and-plan dashboard navigation

# Build incrementally with runtime validation
/implement-and-iterate

# Claude will:
# 1. Implement in small chunks
# 2. Run the code and capture evidence (screenshots for web UIs, logs, output)
# 3. Check if acceptance criteria are met
# 4. Keep going until complete
```

---

## What it does

Adds four slash commands to Claude Code:

- **`/evaluate-and-plan`** - Analyzes current state, creates prioritized work plan
- **`/test-and-implement`** - TDD workflow: write tests, then implement
- **`/implement-and-iterate`** - Iterative workflow: build and validate incrementally
- **`/feature-proposal`** - Generates design proposals for new features

All workflows use `.agent_planning/` directory for status and planning documents.

---

## Commands

### `/evaluate-and-plan [focus area]`

Runs two agents sequentially:
1. `project-evaluator` - Assesses current state vs requirements → `STATUS-*.md`
2. `status-planner` - Converts gaps into work backlog → `PLAN-*.md`

Use this at the start of work, or when you want to re-sync planning docs with reality.

**Example:**
```bash
/evaluate-and-plan API authentication
```

---

### `/test-and-implement [focus area | "plan-first"]`

TDD workflow with two loops:

**TestLoop:**
- `functional-tester` writes tests
- `project-evaluator` validates tests are solid
- Repeats until tests are good

**ImplementLoop:**
- `test-driven-implementer` makes tests pass
- `project-evaluator` checks implementation
- Repeats until no major issues

Tests must fail before implementation. No shortcuts allowed - tests validate real behavior.

**Example:**
```bash
/test-and-implement plan-first
```

**Pass "plan-first" to run `/evaluate-and-plan` first, otherwise uses existing STATUS/PLAN.**

---

### `/implement-and-iterate [focus area | "plan-first"]`

Iterative workflow without tests:

**Loop:**
- `iterative-implementer` builds functionality
- `work-evaluator` runs it and gathers evidence (screenshots, logs, output)
- Compares evidence against acceptance criteria
- Repeats until goals met

For web UIs, uses chrome-devtools MCP to capture screenshots and browser console/network data.

**Example:**
```bash
/implement-and-iterate plan-first
```

Exits when `work-evaluator` confirms completion, or pauses if blocked.

---

### `/feature-proposal [description]`

Runs `product-visionary` agent to design new features.

**Example:**
```bash
/feature-proposal real-time collaboration
```

---

## How it works

### Planning Documents

Everything goes in `.agent_planning/`:

**Generated by agents (don't edit these):**
- `STATUS-<timestamp>.md` - Current state evaluation
- `PLAN-<timestamp>.md` - Prioritized work items
- `WORK-EVALUATION-<timestamp>.md` - Runtime validation results

**Optional (can be edited):**
- `PROJECT_SPEC.md` / `PROJECT.md` - Requirements/specs
- `BACKLOG.md`, `SPRINT.md`, etc. - Additional planning

Max 4 timestamped files kept per prefix (oldest deleted automatically).

### Agents

Commands orchestrate these agents:

| Agent | What it does |
|-------|--------------|
| `project-evaluator` | Analyzes current state, finds gaps |
| `status-planner` | Creates work backlog from gaps |
| `functional-tester` | Writes tests (TDD workflow) |
| `test-driven-implementer` | Implements to pass tests (TDD) |
| `iterative-implementer` | Implements incrementally (non-TDD) |
| `work-evaluator` | Validates with runtime evidence (non-TDD) |
| `product-visionary` | Designs new features |

### MCP Integration

`work-evaluator` can use chrome-devtools MCP for web applications:
- Navigate browsers
- Capture screenshots
- Extract console logs
- Monitor network errors

Configured in `.mcp.json`, auto-installed via npx.

---

## When to use which workflow

**Use TDD (`/test-and-implement`):**
- APIs, backend services
- Libraries, frameworks
- When requirements are clear
- When you want test coverage

**Use Iterative (`/implement-and-iterate`):**
- UI/frontend work
- Exploratory features
- When visual validation matters
- When tests are hard to write upfront

**Both start with `/evaluate-and-plan`** to understand current state.

---

## Examples

### Example 1: API endpoint (TDD)

```bash
/evaluate-and-plan user registration endpoint
# Read STATUS-*.md and PLAN-*.md to see what's missing

/test-and-implement
# Wait for completion, all tests passing
```

### Example 2: Dashboard UI (Iterative)

```bash
/evaluate-and-plan admin dashboard

/implement-and-iterate
# Claude builds incrementally, uses chrome-devtools to capture screenshots
# Validates against acceptance criteria
# Repeats until done
```

### Example 3: Feature design

```bash
/feature-proposal websocket-based notifications
# Review proposal
# Then use /evaluate-and-plan + implementation workflow
```

---

## Rules

**Evaluation:**
- No optimism - partial/incomplete work is flagged
- Everything backed by evidence (file paths, line numbers)
- Runs the code, doesn't just read it

**Tests (TDD workflow):**
- Must fail before implementation
- Validate behavior, not implementation details
- No mocking of the code being tested
- No hardcoded test values in implementation

**Implementation:**
- No TODOs in completed code
- Explicit error handling
- No shortcuts to pass tests

**Evidence (Iterative workflow):**
- Screenshots for web UIs
- Logs and output for everything
- Actual execution, not assumptions

---

## Requirements

- Claude Code (latest)
- git (for commit functionality)
- Node.js (for chrome-devtools MCP, auto-installed)

---

## Documentation

- `plugins/dev-loop/CLAUDE.md` - Detailed plugin guide
- `COMING_SOON.md` - Other plugins in development

---

## Notes

This plugin enforces a workflow. If you prefer ad-hoc development, you won't like it.

The evaluation step can feel slow at first - it's doing real analysis. Worth it to avoid building the wrong thing.

Status reports can be brutally honest. That's intentional.

---

MIT License
